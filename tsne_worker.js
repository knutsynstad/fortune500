!function(t){var r={};function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,r,e){i.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:e})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,r){if(1&r&&(t=i(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var n in t)i.d(e,n,function(r){return t[r]}.bind(null,n));return e},i.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(r,"a",r),r},i.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},i.p="",i(i.s=0)}([function(t,r,i){"use strict";var e=function(t){return t&&t.__esModule?t:{default:t}}(i(1));onmessage=function(t){var r=new e.default.tSNE(t.data.options);r.initDataDist(t.data.data);for(var i=0;i<=t.data.options.steps-1;i+=1)r.step(),postMessage(r.getSolution())}},function(t,r,i){"use strict";var e=e||{REVISION:"ALPHA"};!function(t){var r=function(t,r){if(!t)throw r||"Assertion failed"},i=function(t,r,i){return t.hasOwnProperty(r)?t[r]:i},e=!1,n=0,o=function(t,r){return t+function t(){if(e)return e=!1,n;var r=2*Math.random()-1,i=2*Math.random()-1,o=r*r+i*i;if(0==o||o>1)return t();var a=Math.sqrt(-2*Math.log(o)/o);return n=i*a,e=!0,r*a}()*r},a=function(t){if(void 0===t||isNaN(t))return[];if("undefined"==typeof ArrayBuffer){for(var r=new Array(t),i=0;i<t;i++)r[i]=0;return r}return new Float64Array(t)},s=function(t,r,i){for(var e=void 0!==i,n=[],a=0;a<t;a++){for(var s=[],u=0;u<r;u++)e?s.push(i):s.push(o(0,1e-4));n.push(s)}return n},u=function(t,r){for(var i=t.length,e=0,n=0;n<i;n++){var o=t[n],a=r[n];e+=(o-a)*(o-a)}return e},f=function(t,i,e){var n=Math.sqrt(t.length),o=Math.floor(n);r(o===n,"D should have square number of elements.");for(var s=Math.log(i),u=a(o*o),f=a(o),h=0;h<o;h++){for(var v=-1/0,c=1/0,l=1,d=!1,p=0;!d;){for(var m=0,y=0;y<o;y++){var g=Math.exp(-t[h*o+y]*l);h===y&&(g=0),f[y]=g,m+=g}var M=0;for(y=0;y<o;y++){if(0==m)g=0;else g=f[y]/m;f[y]=g,g>1e-7&&(M-=g*Math.log(g))}M>s?(v=l,c===1/0?l*=2:l=(l+c)/2):(c=l,v===-1/0?l/=2:l=(l+v)/2),p++,Math.abs(M-s)<e&&(d=!0),p>=50&&(d=!0)}for(y=0;y<o;y++)u[h*o+y]=f[y]}var b=a(o*o),Y=2*o;for(h=0;h<o;h++)for(y=0;y<o;y++)b[h*o+y]=Math.max((u[h*o+y]+u[y*o+h])/Y,1e-100);return b};function h(t){return t>0?1:t<0?-1:0}var v=function(t){t=t||{};this.perplexity=i(t,"perplexity",30),this.dim=i(t,"dim",2),this.epsilon=i(t,"epsilon",10),this.iter=0};v.prototype={initDataRaw:function(t){var i=t.length,e=t[0].length;r(i>0," X is empty? You must have some data!"),r(e>0," X[0] is empty? Where is the data?");var n=function(t){for(var r=t.length,i=a(r*r),e=0;e<r;e++)for(var n=e+1;n<r;n++){var o=u(t[e],t[n]);i[e*r+n]=o,i[n*r+e]=o}return i}(t);this.P=f(n,this.perplexity,1e-4),this.N=i,this.initSolution()},initDataDist:function(t){var i=t.length;r(i>0," X is empty? You must have some data!");for(var e=a(i*i),n=0;n<i;n++)for(var o=n+1;o<i;o++){var s=t[n][o];e[n*i+o]=s,e[o*i+n]=s}this.P=f(e,this.perplexity,1e-4),this.N=i,this.initSolution()},initSolution:function(){this.Y=s(this.N,this.dim),this.gains=s(this.N,this.dim,1),this.ystep=s(this.N,this.dim,0),this.iter=0},getSolution:function(){return this.Y},step:function(){this.iter+=1;for(var t=this.N,r=this.costGrad(this.Y),i=r.cost,e=r.grad,n=a(this.dim),o=0;o<t;o++)for(var s=0;s<this.dim;s++){var u=e[o][s],f=this.ystep[o][s],v=this.gains[o][s],c=h(u)===h(f)?.8*v:v+.2;c<.01&&(c=.01),this.gains[o][s]=c;var l=(this.iter<250?.5:.8)*f-this.epsilon*c*e[o][s];this.ystep[o][s]=l,this.Y[o][s]+=l,n[s]+=this.Y[o][s]}for(o=0;o<t;o++)for(s=0;s<this.dim;s++)this.Y[o][s]-=n[s]/t;return i},debugGrad:function(){for(var t=this.N,r=this.costGrad(this.Y),i=(r.cost,r.grad),e=1e-5,n=0;n<t;n++)for(var o=0;o<this.dim;o++){var a=this.Y[n][o];this.Y[n][o]=a+e;var s=this.costGrad(this.Y);this.Y[n][o]=a-e;var u=this.costGrad(this.Y),f=i[n][o],h=(s.cost-u.cost)/(2*e);console.log(n+","+o+": gradcheck analytic: "+f+" vs. numerical: "+h),this.Y[n][o]=a}},costGrad:function(t){for(var r=this.N,i=this.dim,e=this.P,n=this.iter<100?4:1,o=a(r*r),s=0,u=0;u<r;u++)for(var f=u+1;f<r;f++){for(var h=0,v=0;v<i;v++){var c=t[u][v]-t[f][v];h+=c*c}var l=1/(1+h);o[u*r+f]=l,o[f*r+u]=l,s+=2*l}for(var d=r*r,p=a(d),m=0;m<d;m++)p[m]=Math.max(o[m]/s,1e-100);var y=0,g=[];for(u=0;u<r;u++){var M=new Array(i);for(v=0;v<i;v++)M[v]=0;for(f=0;f<r;f++){y+=-e[u*r+f]*Math.log(p[u*r+f]);var b=4*(n*e[u*r+f]-p[u*r+f])*o[u*r+f];for(v=0;v<i;v++)M[v]+=b*(t[u][v]-t[f][v])}g.push(M)}return{cost:y,grad:g}}},t.tSNE=v}(e),function(r){void 0===t||void 0===t.exports?window.tsnejs=r:t.exports=r}(e)}]);